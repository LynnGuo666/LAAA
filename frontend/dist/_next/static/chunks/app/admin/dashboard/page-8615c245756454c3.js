(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[427],{4847:function(e,s,a){Promise.resolve().then(a.bind(a,3706))},3706:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return AdminDashboardPage}});var t=a(7437),l=a(2265),i=a(4033);function AdminDashboardPage(){let e=(0,i.useRouter)(),[s,a]=(0,l.useState)("overview"),[r,d]=(0,l.useState)(!0),[c,n]=(0,l.useState)(null),[o,x]=(0,l.useState)([]),[m,h]=(0,l.useState)([]);(0,l.useEffect)(()=>{checkAdmin()},[]),(0,l.useEffect)(()=>{"overview"===s?loadStats():"logs"===s&&loadLoginLogs()},[s]);let checkAdmin=async()=>{try{var s;let a=await fetch("/api/v1/dashboard/profile",{headers:{Authorization:"Bearer ".concat(null===(s=document.cookie.match(/access_token=([^;]+)/))||void 0===s?void 0:s[1])}});if(a.ok){let s=await a.json();if(!s.is_admin){e.push("/dashboard");return}d(!1)}else e.push("/login")}catch(s){console.error("Failed to check admin status:",s),e.push("/login")}},loadStats=async()=>{try{var e;let s=await fetch("/api/v1/dashboard/admin/stats",{headers:{Authorization:"Bearer ".concat(null===(e=document.cookie.match(/access_token=([^;]+)/))||void 0===e?void 0:e[1])}});if(s.ok){let e=await s.json();n(e)}}catch(e){console.error("Failed to load stats:",e)}},loadLoginLogs=async()=>{try{var e;let s=await fetch("/api/v1/dashboard/admin/logs/login",{headers:{Authorization:"Bearer ".concat(null===(e=document.cookie.match(/access_token=([^;]+)/))||void 0===e?void 0:e[1])}});if(s.ok){let e=await s.json();h(e)}}catch(e){console.error("Failed to load login logs:",e)}};return r?(0,t.jsx)("div",{className:"min-h-full flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),(0,t.jsx)("p",{className:"mt-4 text-gray-600",children:"加载中..."})]})}):(0,t.jsxs)("div",{className:"min-h-full bg-gray-50",children:[(0,t.jsx)("div",{className:"bg-white shadow",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex justify-between items-center py-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"管理员仪表盘"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"系统管理与监控"})]}),(0,t.jsxs)("div",{className:"flex space-x-3",children:[(0,t.jsx)("button",{onClick:()=>e.push("/dashboard"),className:"btn-secondary",children:"用户仪表盘"}),(0,t.jsx)("button",{onClick:()=>e.push("/admin/users"),className:"btn-secondary",children:"用户管理"}),(0,t.jsx)("button",{onClick:()=>e.push("/admin/applications"),className:"btn-secondary",children:"应用管理"}),(0,t.jsx)("button",{onClick:()=>e.push("/admin/permissions"),className:"btn-secondary",children:"权限管理"})]})]})})}),(0,t.jsx)("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"px-4 py-6 sm:px-0",children:[(0,t.jsx)("div",{className:"border-b border-gray-200",children:(0,t.jsx)("nav",{className:"-mb-px flex space-x-8",children:[{key:"overview",label:"总览"},{key:"logs",label:"登录日志"}].map(e=>(0,t.jsx)("button",{onClick:()=>a(e.key),className:"".concat(s===e.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"),children:e.label},e.key))})}),(0,t.jsxs)("div",{className:"mt-6",children:["overview"===s&&(0,t.jsx)("div",{children:c&&(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,t.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,t.jsx)("div",{className:"p-5",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded-md flex items-center justify-center",children:(0,t.jsx)("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),(0,t.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,t.jsxs)("dl",{children:[(0,t.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"总用户数"}),(0,t.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:c.total_users})]})})]})})}),(0,t.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,t.jsx)("div",{className:"p-5",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("div",{className:"w-8 h-8 bg-green-500 rounded-md flex items-center justify-center",children:(0,t.jsx)("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"})})})}),(0,t.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,t.jsxs)("dl",{children:[(0,t.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"总应用数"}),(0,t.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:c.total_clients})]})})]})})}),(0,t.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,t.jsx)("div",{className:"p-5",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("div",{className:"w-8 h-8 bg-yellow-500 rounded-md flex items-center justify-center",children:(0,t.jsx)("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{d:"M10 2L3 7v11a1 1 0 001 1h12a1 1 0 001-1V7l-7-5zM8 15v-3h4v3H8z"})})})}),(0,t.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,t.jsxs)("dl",{children:[(0,t.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"今日登录"}),(0,t.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:c.total_logins_today})]})})]})})}),(0,t.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,t.jsx)("div",{className:"p-5",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("div",{className:"w-8 h-8 bg-purple-500 rounded-md flex items-center justify-center",children:(0,t.jsx)("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),(0,t.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,t.jsxs)("dl",{children:[(0,t.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"今日活跃"}),(0,t.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:c.active_users_today})]})})]})})})]})}),"logs"===s&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"登录日志"}),(0,t.jsx)("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:0===m.length?(0,t.jsx)("p",{className:"text-gray-500 text-center py-8",children:"暂无登录日志"}):(0,t.jsx)("ul",{className:"divide-y divide-gray-200",children:m.map(e=>(0,t.jsx)("li",{className:"px-4 py-4",children:(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.username}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:new Date(e.login_time).toLocaleString()}),(0,t.jsxs)("p",{className:"text-xs text-gray-400",children:[e.ip_address," | ",e.login_method,e.client_name&&" | 通过 ".concat(e.client_name)]})]}),(0,t.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(e.success?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.success?"成功":"失败"})]})})})},e.id))})})]})]})]})})]})}},622:function(e,s,a){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t=a(2265),l=Symbol.for("react.element"),i=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,d=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function q(e,s,a){var t,i={},n=null,o=null;for(t in void 0!==a&&(n=""+a),void 0!==s.key&&(n=""+s.key),void 0!==s.ref&&(o=s.ref),s)r.call(s,t)&&!c.hasOwnProperty(t)&&(i[t]=s[t]);if(e&&e.defaultProps)for(t in s=e.defaultProps)void 0===i[t]&&(i[t]=s[t]);return{$$typeof:l,type:e,key:n,ref:o,props:i,_owner:d.current}}s.Fragment=i,s.jsx=q,s.jsxs=q},7437:function(e,s,a){"use strict";e.exports=a(622)},4033:function(e,s,a){e.exports=a(94)}},function(e){e.O(0,[971,472,744],function(){return e(e.s=4847)}),_N_E=e.O()}]);