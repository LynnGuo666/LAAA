(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[11],{7636:function(e,a,t){Promise.resolve().then(t.bind(t,5878))},5878:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return RegisterPage}});var s=t(7437),n=t(2265),r=t(4033),i=t(6454);function RegisterPage(){let e=(0,r.useRouter)(),a=(0,r.useSearchParams)(),[t,l]=(0,n.useState)({email:"",username:"",password:"",confirmPassword:"",full_name:""}),[o,c]=(0,n.useState)(!1),[d,u]=(0,n.useState)(""),handleChange=e=>{l({...t,[e.target.name]:e.target.value})},handleSubmit=async s=>{if(s.preventDefault(),t.password!==t.confirmPassword){u("密码确认不匹配");return}if(t.password.length<8){u("密码长度至少8个字符");return}c(!0),u("");try{await i.i.register({email:t.email,username:t.username,password:t.password,full_name:t.full_name||void 0});let s=a.toString();e.push("/login".concat(s?"?".concat(s):""))}catch(e){var n,r;u((null===(r=e.response)||void 0===r?void 0:null===(n=r.data)||void 0===n?void 0:n.detail)||"注册失败，请重试")}finally{c(!1)}};return(0,s.jsx)("div",{className:"min-h-full flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-primary-100",children:(0,s.jsx)("svg",{className:"h-8 w-8 text-primary-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})})}),(0,s.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"创建新账户"})]}),(0,s.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:handleSubmit,children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"邮箱地址 *"}),(0,s.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"input-field",placeholder:"输入邮箱地址",value:t.email,onChange:handleChange})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:"用户名 *"}),(0,s.jsx)("input",{id:"username",name:"username",type:"text",autoComplete:"username",required:!0,className:"input-field",placeholder:"输入用户名",value:t.username,onChange:handleChange})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"full_name",className:"block text-sm font-medium text-gray-700",children:"姓名"}),(0,s.jsx)("input",{id:"full_name",name:"full_name",type:"text",autoComplete:"name",className:"input-field",placeholder:"输入您的姓名（可选）",value:t.full_name,onChange:handleChange})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"密码 *"}),(0,s.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,className:"input-field",placeholder:"输入密码（至少8个字符）",value:t.password,onChange:handleChange})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"确认密码 *"}),(0,s.jsx)("input",{id:"confirmPassword",name:"confirmPassword",type:"password",autoComplete:"new-password",required:!0,className:"input-field",placeholder:"再次输入密码",value:t.confirmPassword,onChange:handleChange})]})]}),d&&(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:d}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{type:"submit",disabled:o,className:"btn-primary",children:o?"注册中...":"注册账户"})}),(0,s.jsx)("div",{className:"text-center",children:(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["已有账户？"," ",(0,s.jsx)("a",{href:"/login".concat(a.toString()?"?".concat(a.toString()):""),className:"font-medium text-primary-600 hover:text-primary-500",children:"立即登录"})]})})]})]})})}},6454:function(e,a,t){"use strict";t.d(a,{i:function(){return l}});var s=t(4829),n=t(1490);let r="".concat(window.location.protocol,"//").concat(window.location.host),i=s.Z.create({baseURL:r,headers:{"Content-Type":"application/json"}});i.interceptors.request.use(e=>{let a=n.Z.get("access_token");return a&&(e.headers.Authorization="Bearer ".concat(a)),e}),i.interceptors.response.use(e=>e,e=>{var a;return(null===(a=e.response)||void 0===a?void 0:a.status)!==401||(n.Z.remove("access_token"),n.Z.remove("refresh_token"),window.location.pathname.includes("/login")||(window.location.href="/login/")),Promise.reject(e)});let l={login:async e=>{let a=new FormData;a.append("username",e.username),a.append("password",e.password),a.append("grant_type","password");let t=await s.Z.post("".concat(r,"/oauth/token"),a,{headers:{"Content-Type":"application/x-www-form-urlencoded"}});return t.data},authorize:async e=>{let a=new FormData;Object.entries(e).forEach(e=>{let[t,s]=e;null!=s&&a.append(t,s.toString())});let t=await s.Z.post("".concat(r,"/oauth/authorize"),a,{headers:{"Content-Type":"application/x-www-form-urlencoded"},maxRedirects:0,validateStatus:e=>e<400||e>=300&&e<400});return t},getCurrentUser:async()=>{let e=await i.get("/api/v1/users/me");return e.data},getClientInfo:async e=>{let a=await i.get("/api/v1/clients/".concat(e));return a.data},register:async e=>{let a=await i.post("/api/v1/users",e);return a.data},checkPermission:async(e,a,t)=>{let s=await i.post("/api/v1/permissions/check",{user_id:e,client_id:a,requested_scopes:t});return s.data},createPermissionRequest:async e=>{let a=await i.post("/api/v1/permissions/requests",e);return a.data},getMyPermissionRequests:async()=>{let e=await i.get("/api/v1/permissions/requests/my");return e.data},getUserPermissions:async e=>{let a=await i.get("/api/v1/permissions/user/".concat(e));return a.data},getAllUsers:async()=>{let e=await i.get("/api/v1/users");return e.data},getUserById:async e=>{let a=await i.get("/api/v1/users/".concat(e));return a.data},updateUser:async(e,a)=>{let t=await i.put("/api/v1/users/".concat(e),a);return t.data},deleteUser:async e=>{let a=await i.delete("/api/v1/users/".concat(e));return a.data},getAllClients:async()=>{let e=await i.get("/api/v1/clients");return e.data},updateClient:async(e,a)=>{let t=await i.put("/api/v1/clients/".concat(e),a);return t.data},deleteClient:async e=>{let a=await i.delete("/api/v1/clients/".concat(e));return a.data},createClient:async e=>{let a=await i.post("/api/v1/clients",e);return a.data},getUserPermissionsByAdmin:async e=>{let a=await i.get("/api/v1/admin/users/".concat(e,"/permissions"));return a.data},grantUserPermission:async(e,a,t)=>{let s=await i.post("/api/v1/admin/users/".concat(e,"/permissions/").concat(a),t);return s.data},revokeUserPermission:async(e,a)=>{let t=await i.delete("/api/v1/admin/users/".concat(e,"/permissions/").concat(a));return t.data},getPermissionGroups:async()=>{let e=await i.get("/api/v1/permissions/groups");return e.data},getPermissionGroup:async e=>{let a=await i.get("/api/v1/permissions/groups/".concat(e));return a.data},updatePermissionGroup:async(e,a)=>{let t=await i.put("/api/v1/permissions/groups/".concat(e),a);return t.data}}}},function(e){e.O(0,[745,971,472,744],function(){return e(e.s=7636)}),_N_E=e.O()}]);